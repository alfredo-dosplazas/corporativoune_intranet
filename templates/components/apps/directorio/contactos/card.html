<div id="card_{{ contacto.pk }}"
     data-theme="{{ contacto.empresa.theme }}"
     class="relative card w-full bg-base-100 rounded-xl
            border border-base-300
            shadow-sm hover:shadow-lg transition
            print:shadow-none print:border-base-300
            {% if contacto.usuario and not contacto.usuario.is_active %}opacity-70 grayscale{% endif %}">

    <!-- Empresa accent line -->
    {% if contacto.empresa %}
        <div class="absolute top-0 inset-x-0 h-1
                bg-gradient-to-r
                from-[var(--color-primary-light)]
                via-primary
                to-[var(--color-primary-dark)]
                rounded-t-xl">
        </div>
    {% endif %}

    <div class="card-body p-5 gap-4">

        <!-- HEADER -->
        <div class="flex items-start gap-4">

            <!-- FOTO USUARIO -->
            {% if contacto.foto %}
                <div class="avatar shrink-0">
                    <div class="w-16 h-16 rounded-full ring ring-primary ring-offset-2 ring-offset-base-100">
                        <img src="{{ contacto.foto.url }}"
                             alt="{{ contacto.nombre_completo }}"
                             class="object-cover"/>
                    </div>
                </div>
            {% endif %}

            <!-- INFO PRINCIPAL -->
            <div class="flex-1 min-w-0">
                <h2 class="text-primary text-lg font-semibold leading-tight truncate"
                    title="{{ contacto.nombre_completo }}"
                >
                    {% if perms.directorio.view_contacto %}
                        <a href="{% url 'directorio:detail' contacto.pk %}">{{ contacto.nombre_completo }}</a>
                    {% else %}
                        {{ contacto.nombre_completo }}
                    {% endif %}
                </h2>

                {% if contacto.numero_empleado %}
                    <p class="text-xs opacity-60">
                        No. Empleado {{ contacto.numero_empleado }}
                    </p>
                {% endif %}

                <p class="text-sm opacity-80 truncate">
                    {{ contacto.area.nombre|default:"√Årea no asignada" }}
                </p>

                {% if contacto.usuario and not contacto.usuario.is_active %}
                    <span class="badge badge-sm mt-1">Inactivo</span>
                {% endif %}
            </div>

            <!-- LOGO EMPRESA -->
            {% if contacto.empresa and contacto.empresa.abreviatura %}
                <div class="shrink-0 flex items-center">
                    <c-component
                            is="apps.empresas.logos.{{ contacto.empresa.abreviatura }}"
                            class="
                                h-10 w-auto
                                text-primary
                                opacity-80
                                print:opacity-100
                            "
                    />
                </div>
            {% endif %}
        </div>

        <!-- DIVIDER -->
        <div class="divider my-1"></div>

        <!-- CONTACTO -->
        <div class="grid gap-2 text-sm">

            {% if contacto.email_principal %}
                <div class="flex items-center gap-2">
                    <span class="icon-[material-symbols--mail-outline] text-primary"></span>
                    <a href="mailto:{{ contacto.email_principal.email }}"
                       class="truncate hover:underline">
                        {{ contacto.email_principal.email }}
                    </a>
                </div>
            {% endif %}

            {% if contacto.telefono_principal %}
                <div class="flex items-center gap-2">
                    <span class="icon-[material-symbols--call-outline] text-primary"></span>
                    <a href="tel:{{ contacto.telefono_principal.telefono }}">
                        {{ contacto.telefono_principal.telefono }}
                    </a>
                </div>
            {% endif %}

            {% if contacto.extension %}
                <div class="flex items-center gap-2 opacity-70">
                    <span class="icon-[material-symbols--dialpad-outline]"></span>
                    <span>Ext. {{ contacto.extension }}</span>
                </div>
            {% endif %}
        </div>

        <!-- FOOTER -->
        <div class="flex items-center justify-between pt-3">

            {% if contacto.empresa %}
                <span class="text-xs uppercase tracking-wide opacity-60">
                {{ contacto.empresa.nombre_corto }}
            </span>
            {% endif %}

            <div class="flex gap-2 print:hidden">

                {% if perms.directorio.view_contacto %}
                    <a href="{% url 'directorio:detail' contacto.pk %}"
                       class="btn btn-xs btn-outline">
                        Ver
                    </a>
                {% endif %}

                {% if perms.directorio.change_contacto %}
                    <a href="{% url 'directorio:update' contacto.pk %}"
                       class="btn btn-xs btn-outline btn-info">
                        Editar
                    </a>
                {% endif %}

                {% if contacto.slack_id %}
                    <a href="{{ contacto.slack_url }}"
                       class="btn btn-xs btn-outline btn-primary">
                        <span class="icon-[devicon--slack]"></span>
                        Slack
                    </a>
                {% endif %}

            </div>
        </div>

    </div>
</div>
